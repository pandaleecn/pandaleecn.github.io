---
layout: post
title: 'Runtime总结'
date: 2018-02-07
author: 李大鹏
cover: ''œ
tags: iOS Runtime
---

#### 1. [obj foo]和 objc_msgSend()函数之间有什么关系？

- [obj foo] 在编译器处理后变成了 objc_msgSend 调用，第一个参数是 obj，第二个参数是 foo，开始 runtime 消息传递过程。

#### 2. runtime 如何通过 Selector 找到对应的 IMP 地址的？

- 首先查找当前实例对应类对象的缓存是否有 Selector 的 IMP 实现，如果命中了，就会返回该实现给调用方；
- 如果没有命中，就会根据当前类的方法列表，查找方法的实现；
- 当前类没有命中，根据 superclass 指针，查找父类的方法实现。

#### 3. 能否向编译后的类中增加实例变量？

- 首先区分编译后的还是动态添加的类
- 编译之前，创建的类已经完成了实例变量的布局，class_ro_t。
- 编译后的类无法修改，不能增加实例变量。
- 如果是动态添加类，可以在添加过程中，调用注册类方法前添加可以实现。
