---
layout: post
title: 'iOS进阶知识点2'
date: 2019-08-01
author: 李大鹏
cover: ''
tags: iOS
---

#### 1.掉帧的情况和解决方案

在设计一个动画时，由于画面组合元素较多，使用了贝塞尔曲线路径等原因，导致在 60Hz 内没有处理完成，产生掉帧的现象。经过和产品、UI、UX 沟通，设计了合理的时间间隔和元素组合，解决了问题。

#### 2.网络优化

服务器在香港，网络经常不稳定，有的时候 DNS 无法解析

- 两种重连方式：IP 直连和网关代理服务；
- 两种重试方式：非关键义务，使用 Http 重试，消除 SSL 风险；原请求重试。

#### 组件化

#### 3.音视频

- 音，导游直播讲解
- 视，商品视频采集、UGC 列表视频

#### 4.Socket

- IM
- 智能音响

#### 2.HTTPS 安全机制

- 非对称加密，交换秘钥。发起方 RSA 生成 k1、k2，明文发送 k1 给接收方，保留 k2，k1 机密的数据只有 k2 能解密；
- 接收方收到后使用 k1 加密对称秘钥后，发送回发起方，后续使用 k1 进行对称加密的会话；
- CA 权威机构颁发证书，认证网站合法组织，防止中间人劫持。系统或浏览器安装时会附带他们颁发的 CA 证书列表，如果有非法用途，将会更新 CA 颁发的所有该服务商的证书为不安全。
- 非对称加密 + 对称加密 + CA 认证，保持 HTTPS 的安全。
- iOS 实现：通讯内容本身加密 AES256、ssl pinning 证书绑定（内置仅接受指定域名的证书），证书校验有文件校验和公钥校验两种模式。证书文件校验更新机制，服务器下发特定的错误码，触发客户端的新证书下载流程。公钥校验只验证是否匹配，过期公钥也未变，能完成校验。

#### 3.架构设计模式

- SOA，面向服务的架构。将应用程序的不同功能单元（称为服务）进行拆分，并通过这些服务之间定义良好的接口和协议联系起来。接口是采用中立的方式进行定义的，它应该独立于实现服务的硬件平台、操作系统和编程语言。
- DDD，领域驱动设计。
  - 用户界面/展现层。负责向用户展现信息以及解释用户命令。请求应用层以获取用户所需要展现的数据；发送命令给应用层要求其执行某个用户命令；
  - 应用层。很薄的一层，定义软件要完成的所有任务。对外为展现层提供各种应用功能（包括查询或命令），对内调用领域层（领域对象或领域服务）完成各种业务逻辑，应用层不包含业务逻辑。
  - 领域层。负责表达业务概念，业务状态信息以及业务规则，领域模型处于这一层，是业务软件的核心。
  - 基础设施层。本层为其他层提供通用的技术能力；提供了层间的通信；为领域层实现持久化机制；总之，基础设施层可以通过架构和框架来支持其他层的技术需求。

#### 4.MVVM

#### firebase
